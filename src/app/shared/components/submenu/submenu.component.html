<div class="flex flex-col justify-between h-full p-4 w-full lg:w-64">
  <div class="flex-1 flex flex-col">
    <app-search-input
      [(model)]="searchQuery"
      (modelChange)="onSearchChange()"
      placeholder="Quick search"
    />

    <!-- Chat-specific layout -->
    <ng-container *ngIf="isChatMenu">
      <!-- Favourites Section -->
      <div class="section mt-3 lg:mt-5">
        <!-- <div class="section-title mb-3 text-sm text-gray-400">FAVOURITES</div> -->
        <div class="mb-1 mt-2 font-semibold">Action Menu</div>
        <div class=" p-1 space-y-0.5 sm:space-y-1">
          <div
            *ngFor="let contact of filteredActionMenu"
            (click)="selectSubmenu(contact.id)"
            class="contact-item flex items-center space-x-3 px-3 py-1.5 sm:py-2 rounded-md cursor-pointer transition-all duration-200 ease-in-out overflow-hidden"
            [ngClass]="{
              'bg-mint-25 ring-1 ring-mint-200 border-mint-200 border-b-2':
                contact.id === activeSubmenu,
              'hover:bg-fade-white border-b-transparent':
                contact.id !== activeSubmenu
            }"
          >
            <div class="relative shrink-0">
              <ng-container *ngIf="!contact.imageURL; else avatarImage">
                <div
                  class="w-7 h-7 rounded-full bg-mint-25 flex items-center justify-center text-mint-600 text-xs font-medium uppercase"
                >
                  {{ getInitials(contact.name) }}
                </div>
              </ng-container>
              <ng-template #avatarImage>
                <img
                  [src]="contact.imageURL"
                  class="w-5 h-5 object-contain shrink-0"
                />
              </ng-template>
            </div>
            <span class="text-sm truncate">{{ contact.name }}</span>
            <div
              *ngIf="contact.badgeCount"
              class="badge bg-mint-50 px-1.5 py-1 rounded-md text-xs"
            >
              {{ contact.badgeCount }}
            </div>
          </div>
        </div>
      </div>

      <!-- Channels Section -->
      <div class="section mt-5 lg:mt-6 flex-1 flex flex-col">
        <div class="flex items-center justify-between mb-1">
          <h2 class="font-medium">Chat Channels</h2>
          <div class="">
            <div
              (click)="openChannelModal()"
              class="bg-fade-white hover:bg-fade-white border border-fade-white p-1 rounded-full cursor-pointer"
            >
              <img
                src="assets/icons/add-icon.svg"
                class="w-[11px] object-contain"
              />
            </div>
          </div>
        </div>
        <div
          class="flex-1 max-h-28 sm:max-h-32 md:max-h-40 overflow-y-auto p-1 space-y-1"
        >
          <div
            *ngFor="let channel of filteredChannels"
            (click)="selectSubmenu(channel.id)"
            class="channel-item flex items-center space-x-3 px-3 py-1.5 sm:py-2 rounded-md cursor-pointer transition-all duration-200 ease-in-out overflow-hidden"
            [ngClass]="{
              'bg-mint-50 ring-1 ring-mint-200 border-mint-200 border-b-2':
                channel.id === activeSubmenu,
              'hover:bg-fade-white border-b-transparent':
                channel.id !== activeSubmenu
            }"
          >
            <img
              [src]="channel.imageURL || 'assets/images/default-avatar.jpg'"
              class="avatar w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7 rounded-full shrink-0"
            />
            <span class="text-sm truncate">{{ channel.name }}</span>
            <div
              *ngIf="channel.badgeCount"
              class="badge bg-mint-50 px-1.5 py-1 rounded-md text-xs"
            >
              {{ channel.badgeCount }}
            </div>
          </div>
        </div>
      </div>
    </ng-container>
    <ng-container *ngIf="!isChatMenu">
      <div class="mb-3 mt-2 font-semibold">Action Menu</div>
      <div class="h-[196px] overflow-y-auto p-1 space-y-1">
        <div
          *ngFor="let item of filteredItems"
          (click)="selectSubmenu(item.key)"
          class="flex items-center gap-2 px-3 py-2 rounded-md w-52 cursor-pointer transition-all duration-200 ease-in-out"
          [ngClass]="{
            'bg-mint-25 ring-1 ring-mint-200 border-mint-200 border-b-2':
              item.key === activeSubmenu,
            'hover:bg-fade-white border-b-transparent':
              item.key !== activeSubmenu
          }"
        >
          <img
            [src]="item.icon"
            [alt]="item.label"
            class="w-5 h-5 object-contain"
          />
          <span class="text-sm text-black">{{ item.label }}</span>
        </div>
      </div>

      <div class="mt-6">
        <div class="flex items-center justify-between mb-4">
          <h2 class="font-medium">Chat Channels</h2>
          <div class="h-[36px] overflow-y-auto">
            <button
              (click)="openChannelModal()"
              class="bg-fade-white hover:bg-fade-white border border-fade-white p-1 rounded-full cursor-pointer"
            >
              <img
                src="assets/icons/add-icon.svg"
                class="w-[11px] object-contain"
              />
            </button>
          </div>
        </div>

        <div class="space-y-2 h-[196px] overflow-y-auto p-1">
          <div
            *ngFor="let message of filteredDirectMessages"
            (click)="selectSubmenu(message.id)"
            class="contact-item flex items-center space-x-3 px-3 py-2 rounded-md cursor-pointer transition-all duration-200 ease-in-out"
            [ngClass]="{
              'bg-mint-25 ring-1 ring-mint-200 border-mint-200 border-b-2':
                message.id === activeSubmenu,
              'hover:bg-fade-white border-b-transparent':
                message.id !== activeSubmenu
            }"
          >
            <img
              [src]="message.imageURL || 'assets/images/default-avatar.jpg'"
              class="avatar w-7 h-7 rounded-full"
            />
            <span class="text-sm">{{ message.name }}</span>
            <div
              *ngIf="message.badgeCount"
              class="badge bg-mint-50 px-1.5 py-1 rounded-md text-xs"
            >
              {{ message.badgeCount }}
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>

  <div>
    <div
      class="max-w-full lg:max-w-[208px] max-h-[182px] mx-auto rounded-2xl border border-[#EDEDED] bg-[#f9f9f9] p-2 md:p-3 text-center mt-1"
    >
      <div class="flex justify-center mb-1 sm:mb-2">
        <div class="rounded-full bg-mint-50 p-1.5">
          <img src="assets/icons/king-icon.svg" />
        </div>
      </div>
      <h2 class="font-semibold text-primary-text text-sm sm:text-base">
        Upgrade to
        <span
          class="bg-mint-50 text-mint-400 text-xs sm:text-sm font-medium px-2 py-0.5 rounded-md ml-1 align-middle"
          >Pro</span
        >
      </h2>
      <p class="text-fade-text mt-1 sm:mt-2 text-[8px] sm:text-xs">
        Dorem ipsum dolor sit amet, consectetur adipiscing elit.
      </p>

      <app-primary-button
        [text]="'Learn more'"
        fontSize="text-xs sm:text-sm"
        padding="py-1.5 sm:py-2 px-3"
        width="w-[95px] sm:w-[108px] !mt-2 md:!mt-4"
      ></app-primary-button>
    </div>
  </div>
</div>
